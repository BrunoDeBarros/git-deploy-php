<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Git-deploy-php by BrunoDeBarros</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Git-deploy-php</h1>
          <h2>git-deploy-php is a simple php-based tool that deploys your Git repositories to FTP/SFTP servers, and keeps them updated automatically.</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/BrunoDeBarros/git-deploy-php/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/BrunoDeBarros/git-deploy-php/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/BrunoDeBarros/git-deploy-php" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>
<a name="git-deploy-php-20" class="anchor" href="#git-deploy-php-20"><span class="octicon octicon-link"></span></a>git-deploy-php 2.0</h1>

<p>git-deploy-php allows quick and easy deployments of Git repositories to FTP or SFTP servers. You DO NOT need to have git installed on the server. Great for shared servers where you have no shell access, and to save bandwidth and time by only uploading the files that have changed.</p>

<h2>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h2>

<ol>
<li>Drop <code>git-deploy</code> into your project.</li>
<li>Create the <code>deploy.ini</code> file (see below).</li>
<li>Run <code>php git-deploy</code> in your command line / terminal.</li>
</ol><p>And there you go. It's that simple.</p>

<h3>
<a name="deployini" class="anchor" href="#deployini"><span class="octicon octicon-link"></span></a>deploy.ini</h3>

<p>In the root directory of your project, create a <code>deploy.ini</code> file.</p>

<p><em>Note: <code>deploy.ini</code> is the default file's name. You can name it anything you want (for example, <code>staging.ini</code>), and run <code>php git-deploy staging</code>. That serves as an easy way to separate the deployment to staging and production servers.</em></p>

<pre><code>; This is a sample deploy.ini file.

[example]

skip = false
user = example
pass = password    
host = example.com
port = 21
path = /path/to/installation
passive = true

; If that seemed too long for you, you can specify servers like this:
[ftp://example:password@example.com:21/path/to/installation]
</code></pre>

<p>The first time it's executed, git-deploy will assume that your deployment server is empty, and will upload all the files in the git repository.
If you've already deployed your project's files previously, you have to create a REVISION file on your deployment server, containing the hash of the commit it's currently in.</p>

<p>To get the hash of the current commit, you can use:</p>

<pre><code>git rev-parse HEAD
</code></pre>

<h2>
<a name="advanced-usage" class="anchor" href="#advanced-usage"><span class="octicon octicon-link"></span></a>Advanced Usage</h2>

<h3>
<a name="using-sftp" class="anchor" href="#using-sftp"><span class="octicon octicon-link"></span></a>Using SFTP</h3>

<p>To use SFTP, you have two options. With the long-form deploy.ini configuration, you just need to add <code>scheme = sftp</code>. With the short-form, you just need to change <code>ftp://</code> to <code>sftp://</code>.</p>

<p>If you want to use a private key to login instead of a password, you can do so by adding the following to your deploy.ini configuration:</p>

<pre><code>sftp_key = /path/to/key/file
</code></pre>

<h3>
<a name="revert-a-deployment" class="anchor" href="#revert-a-deployment"><span class="octicon octicon-link"></span></a>Revert a deployment</h3>

<p>If you deployed using git-deploy and you want to go back to the previous deployment, all you need is <code>--revert</code>:</p>

<pre><code>php git-deploy --revert [your_ini_file_name]
</code></pre>

<p>If you use deploy.ini (i.e., if you didn't give the .ini file a custom name), then you can simply use:</p>

<pre><code>php git-deploy --revert
</code></pre>

<h3>
<a name="deploy-a-specific-commit" class="anchor" href="#deploy-a-specific-commit"><span class="octicon octicon-link"></span></a>Deploy a specific commit</h3>

<pre><code>php git-deploy -r [your_commit_hash] [your_ini_file_name]
</code></pre>

<p>If you use deploy.ini (i.e., if you didn't give the .ini file a custom name), then you can simply use:</p>

<pre><code>php git-deploy -r [your_commit_hash]
</code></pre>

<p>Note: If you want to, instead of using a commit hash, you can use a tag, or any other valid reference.</p>

<h3>
<a name="deploy-the-latest-commit-from-different-branches" class="anchor" href="#deploy-the-latest-commit-from-different-branches"><span class="octicon octicon-link"></span></a>Deploy the latest commit from different branches</h3>

<p>Sometimes you might need to deploy code from different branches to different servers (e.g. from the develop branch to the staging server, and from the master branch to the production server). This is easy to do. Add the following to your deploy.ini configuration:</p>

<pre><code>branch = develop
</code></pre>

<p>git-deploy will then always deploy the latest commit from the develop branch to the server.</p>

<h3>
<a name="list-files-to-upload-and-delete" class="anchor" href="#list-files-to-upload-and-delete"><span class="octicon octicon-link"></span></a>List files to upload and delete</h3>

<p>Sometimes, you may just want to see what files are to be uploaded to the FTP server, and which ones are to be deleted. In this case, you can use <code>-l</code> (lowercase L):</p>

<pre><code>php git-deploy -l [your_ini_file_name]
</code></pre>

<p>If you use deploy.ini (i.e., if you didn't give the .ini file a custom name), then you can simply use:</p>

<pre><code>php git-deploy -l
</code></pre>

<p>Pretty simple, huh?</p>

<h3>
<a name="clean-remote-directories-automatically" class="anchor" href="#clean-remote-directories-automatically"><span class="octicon octicon-link"></span></a>Clean remote directories automatically</h3>

<p>If you have directories you use for caching that you'd like to clear when you deploy a new commit, you can add the following to your .ini file:</p>

<pre><code>clean_directories[] = folder/to/clean
clean_directories[] = another/folder
</code></pre>

<p>And git-deploy will empty those directories for you.</p>

<h3>
<a name="ignore-files" class="anchor" href="#ignore-files"><span class="octicon octicon-link"></span></a>Ignore files</h3>

<p>If you have files that you don't want uploaded to your server, you can add the following to your .ini file:</p>

<pre><code>ignore_files[] = file/toignore.txt
ignore_files[] = another/file/toignore.php
</code></pre>

<p>And git-deploy will ignore those files.</p>

<h3>
<a name="upload-untracked-files" class="anchor" href="#upload-untracked-files"><span class="octicon octicon-link"></span></a>Upload untracked files</h3>

<p>If you have files that you're not tracking in your repository but that you'd still like to upload, you can add the following to your .ini file:</p>

<pre><code>upload_untracked[] = folder/to/upload
upload_untracked[] = another/file/toignore.php
</code></pre>

<p>And git-deploy will automatically upload those files for you. This is super useful for things like Composer, which recommends that you don't track the vendor folder in your git repo. This way, you can have git-deploy upload the entire vendor folder to the server, and you won't need Composer installed on it.</p>

<h3>
<a name="enable-maintenance-mode-on-your-website-for-the-duration-of-the-deployment" class="anchor" href="#enable-maintenance-mode-on-your-website-for-the-duration-of-the-deployment"><span class="octicon octicon-link"></span></a>Enable maintenance mode on your website for the duration of the deployment</h3>

<p>If you want to take your website down with an "under maintenance" page to prevent users from seeing errors during the middle of a deployment, you can ask git-deploy to automatically turn maintenance mode on prior to deploying, and off at the end of the deployment.</p>

<p>It works by modifying a file specified by the <code>maintenance_file</code> option in your <code>deploy.ini</code>. It'll set that file's contents to <code>maintenance_on_value</code> at the start of the deployment and then set its contents to <code>maintenance_off_value</code> at the end of the deployment. For example:</p>

<pre><code>maintenance_file = 'maintenance.php'
maintenance_on_value = '&lt;?php $under_maintenance = true;?&gt;'
maintenance_off_value = '&lt;?php $under_maintenance = false;?&gt;'
</code></pre>

<p>Note: It's up to your application to detect whether or not maintenance mode is on by checking the <code>maintenance_file</code>, and proceed accordingly.</p>

<h2>
<a name="how-it-works" class="anchor" href="#how-it-works"><span class="octicon octicon-link"></span></a>How It Works</h2>

<p>git-deploy stores a file called REVISION on your server. This file contains the hash of the commit that you've deployed to that server. When you run git-deploy, it downloads that file and compares the commit reference in it with the commit you're trying to deploy to find out which files to upload.</p>

<p>git-deploy also stores a REVISION file for each submodule in your repository, as well as a PREVIOUS_REVISION file for both your repository and each submodule. This allows it to keep your submodules up-to-date, as well as to know which commit to go back to you when you run <code>php git-deploy --revert</code>.</p>

<h2>
<a name="suggestions-questions-and-complaints" class="anchor" href="#suggestions-questions-and-complaints"><span class="octicon octicon-link"></span></a>Suggestions, questions and complaints.</h2>

<p>If you've got any suggestions, questions, or anything you don't like about git-deploy, <a href="https://github.com/BrunoDeBarros/git-deploy-php/issues">you should create an issue here</a>. Feel free to fork this project, if you want to contribute to it. </p>
        </section>

        <footer>
          Git-deploy-php is maintained by <a href="https://github.com/BrunoDeBarros">BrunoDeBarros</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>